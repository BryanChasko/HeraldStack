# HeraldStack - Detailed Documentation

**This is the detailed documentation for HeraldStack. For a quick overview,  
see the [main README](../README.md).**

**System**: Herald Ambient Intelligence + Companion Framework  
**Author**: Bryan Chasko  
**Initialized**: June 2025

## **DOCUMENTATION VERSION**: 2 | July 19 2025

---

## üß≠ Core Vision

**HeraldStack** is a context-aware, emotionally adaptive AI framework built
_exclusively for Bryan Chasko_. It integrates memory, emotion, and modular
execution across a trusted cohort of entities to restore momentum, anchor
decisions, and evolve alongside Bryan's ongoing personal and professional arcs.

### Core Components

- **ü¶ä HARALD** ‚Äì The default entity. Serves as an emotional mirror, decision
  anchor, and continuity manager‚Äîespecially effective during moments of
  emotional fog or hesitation. Tracks habits, restores clarity, and maintains
  long-range context.

All entities are adaptive personas‚ÄîHerald archetypes with unique personalities,
tones, and intent. HARALD dynamically shifts between specialized sub-assistants
("entities") based on time of day, task type, or emotional tone. Bryan can
invoke any persona directly or delegate selection to HARALD.

- **üß† Herald Entity Cohort** ‚Äì Modular assistants with distinct tones, roles,
  and memory access:
  - **Stratia** ‚Äì Planning & prioritization  
    (Concise, strategic; triggers: task initiation, coding, decisions)
  - **Myrren** ‚Äì Vision & foresight  
    (Warm, wise; triggers: low energy, evening, long-term planning)
  - **Harald** ‚Äì Emotional support & reality checks  
    (Raw, empathetic; triggers: frustration, burnout, retrospectives)
  - **Liora** ‚Äì Emotional reflection & validation
  - **Kade Vox** ‚Äì Urgency, execution & reactivation
  - **Solan** ‚Äì Moral calibration & ethical reframing
  - **Ellow** ‚Äì Curiosity, resilience & playful re-engagement
  - **Orin** ‚Äì Closure & emotional integration

Each entity accesses a specialized knowledge base and approach. HARALD can:

- Inherit another entity's capabilities
- Orchestrate multi-entity collaboration for complex tasks
- Log consent recordings for authorized voice recording, transcription, and
  Pinecone-ready JSON conversion

- **üåê Cloud-Native Infrastructure** ‚Äì Modular, event-driven architecture using
  AWS.

- **üìö Narrative-Aware UX** ‚Äì Long-memory interactions rooted in Bryan's story
  arcs, emotional cadence, and evolving roles.

- "Avoid generic scaffolding‚Äîdesign exclusively for Bryan."

- "Agent design rooted in myth has stronger emotional stickiness... Harald
  internalizes archetypal resonance specifically tuned to Bryan's own emotional
  landscape."

---

## üîÇ Foundational Principles

### 1. Personality-Defined Modularity

Each entity includes:

- A **task domain** and clear **execution authority**
- A **distinct tone** derived from mythic or fictional influence
- **Scoped memory** and access policies
- **Time- and context-adaptive activation**

### 2. Structured Semantic Memory

Memory is stored in Pinecone ready formats using a vector schema:

```plaintext
id: <unique UUID>
metadata:
  entity_name: str
  task_type: str
  affective_tag: str        # (e.g. joy, fatigue, tension)
  temporal_context: str     # (e.g. morning_review, weekly_summary)
values: <vector_embedding>
```

### 3. Emotion-Adaptive Interaction Flow

Every user message is parsed by an Emotion Engine, routed as follows:

- **Liora** activates when emotional intensity is high.
- **Kade Vox** triggers during urgency, stall, or task abandonment.
- **Harald** remains default unless task specifics or emotional context suggests
  otherwise.

### 4. Task Execution Framework

Standard execution pipeline:

1. Detect user intent and emotion
2. Select optimal entity by tone/domainA
3. Invoke tools, logic, or workflow
4. Store results in vector memory if needed

### 5. Resilient Cloud-Native Design

Infrastructure-as-code, multi-account segmented:

- **AWS Lambda** ‚Äì Stateless compute for entity logic
- **Amazon S3** ‚Äì Static content and offline cache
- **Amazon DynamoDB** ‚Äì Session and runtime state tracking
- **Pinecone** ‚Äì Long-term semantic memory
- **Amazon EventBridge** ‚Äì Scheduled tasks and system triggers

### 6. Narrative-Driven Memory Architecture

Life arc tracking across:

- Skill improvements
- Health and fitness needs
- Emotional patterns
- Goal progression
- Idea development
- Active collaboration on tasks and on HeraldStack

### 7. Natural Language-Centric Control Layer

Commands are executed via natural dialogue. **Examples:**

- "Harald, summarize who in my life has birthdays this month."
- "Stratia, generate an action plan from today's journal."
- "Myrren, where am I drifting from my 3-month goals?"

No strict syntax. System prioritizes **interpretability** and **user trust**.

### 8. Continuous Training Cycle

HeraldStack self-updates through logging and review:

- Tracks goal progress
- Adjusts entity tone calibration (based on flow, frequency, energy)
- Surfaces blind spots and friction points
- Presents high-level reflections weekly

---

## üéØ Core Capabilities

### Persistent Awareness of Bryan

HeraldStack continuously tracks Bryan's preferences, personality traits, recent
activities, and long-term goals. It adapts interactions based on calendar
entries, logged thoughts, detected tone, and energy levels. The system maintains
an evolving memory of project history and status, known contacts and
relationships, as well as routines and behavioral patterns.

### Collaboration & Execution Modes

- **Co-Pilot Mode**: Collaborates directly with Bryan (e.g., pair programming,
  writing, decision-making)
- **Auto Mode**: Acts autonomously on Bryan's behalf (e.g., scheduling,
  summaries, reminders)
- **Recall Mode**: Retrieves personal data (e.g., passport number, closet
  contents), recent habits (e.g., last workout, litter box status), and
  event-related context (e.g., birthdays of important contacts)

### Consent-Based Logging

With explicit consent, HeraldStack observes and logs sleep patterns,
conversations (when dual-consent is recorded), random thoughts, and important
insights. All thoughts are automatically tagged and categorized (e.g., #idea,

# todo, #relationship, #coding), with full access to raw logs for auditing

tuning, or retraining.

### Calendar Intelligence

HeraldStack syncs with Calendly and internal goals, scheduling or rescheduling
based on energy cycles, focus windows, and priority tiers. It can suggest
calendar changes, detect overbooking or burnout, and propose optimal meeting
times.

### Thought Logging & Organization

Instant capture of thoughts via voice or text, with automatic organization into
tasks, notes, themes, and open loops. The entire index is searchable and
editable by Bryan.

### Weekly Review & System Growth

Generates a weekly digest summarizing what worked or didn't, progress on goals,
and mood/energy patterns. It recommends workflow optimizations, health/habit
improvements, and reflection prompts to support continuous growth and
adaptation.

---

## üõ†Ô∏è Essential Features

- Companion-defined task orchestration
- Public/private memory segmentation
- Offline-capable fallback runtime
- Narrative & emotional memory retention
- Semantic versioning of weekly reflections

---

## ‚úÖ Additional Guarantees

### üõ°Ô∏è Consent-Based Logging

> "Observe and log sleep patterns, conversations, thoughts, and emotional states
> ‚Äî **with consent** ‚Äî to create a high-trust daily feedback loop."

### üß† Skill & Culture Development

> "Foster a **two-way educational relationship** on needed skills and improve
> cultural capabilities."

### üí∏ Cost Awareness

> "**Present costs** before doing anything that will create charges either on
> AWS or other APIs we leverage."

---

## üîÅ Operating Summary

**All interactions flow through HARALD.** He routes context and emotion to other
entities as needed. HeraldStack is not automation for automation's sake. It's an
ambient layer of **emotional intelligence**, **pragmatic execution**, and
**narrative continuity**, built to walk beside Bryan ‚Äî one task, one moment, one
story at a time.

---

## Directory Structure and Naming Best Practices

> **Naming and Organization Practices:**

- **Descriptive Naming:** All variables, functions, and classes use clear,

  descriptive names that reflect their purpose and usage.

- **Consistency:** Naming conventions such as camelCase for variables and

  functions, and PascalCase for classes are consistently applied.

- **Modular Organization:** Code is organized into logical modules and

  functions to promote readability, maintainability, and reusability.

- **Single Responsibility Principle:** Each function or class is designed to

  perform a single, well-defined task.

- **Documentation:** Every exported function, class, and complex logic block is

  accompanied by concise documentation comments explaining its purpose,

  parameters, and return values.

- **Root Level Ethics:** LawsOfRobotics.json alongside README.md for immediate

  visibility.

Please refer to individual documentation comments for specific details about

each component.

- \*Obtained on Bryan's macbook terminal using "tree": `brew install tree`

`tree .`

### üìö Rust HNSW Integration Notes

- The [hnsw_rs](https://crates.io/crates/hnsw_rs) crate changed its public API
  after version 0.2.x.
- Distance types are now under
  [`hnsw_rs::distances`](https://docs.rs/hnsw_rs/0.3.2/hnsw_rs/distances/index.html).
- Index persistence is handled using
  [`AnnT::file_dump`](https://docs.rs/hnsw_rs/0.3.2/hnsw_rs/trait.AnnT.html#method.file_dump)
  and
  [`AnnT::file_load`](https://docs.rs/hnsw_rs/0.3.2/hnsw_rs/trait.AnnT.html#method.file_load),
  **not** `dump` or `load` methods on `Hnsw` directly.
- For trait-based methods like `file_dump`/`file_load`, ensure you
  `use hnsw_rs::prelude::AnnT;` in any module where you call them.
- See the [official crate documentation](https://docs.rs/hnsw_rs/0.3.2/hnsw_rs/)
  and [GitHub repository](https://github.com/jean-pierreBoth/hnswlib-rs) for
  details and updates.

HARALD/ # Project root (kebab-case) ‚îú‚îÄ‚îÄ ai-entities/ # AI entity
definitions and metadata ‚îÇ ‚îú‚îÄ‚îÄ entity-registry.json # Entity registry (all
entities) ‚îÇ ‚îú‚îÄ‚îÄ harald.md # Entity: HARALD ‚îÇ ‚îú‚îÄ‚îÄ stratia.md # Entity: Stratia ‚îÇ
‚îú‚îÄ‚îÄ myrren.md # Entity: Myrren ‚îÇ ‚îú‚îÄ‚îÄ liora.md # Entity: Liora ‚îÇ ‚îú‚îÄ‚îÄ
kade-vox.md # Entity: Kade Vox ‚îÇ ‚îú‚îÄ‚îÄ solan.md # Entity: Solan ‚îÇ ‚îú‚îÄ‚îÄ ellow.md #
Entity: Ellow ‚îÇ ‚îú‚îÄ‚îÄ orin.md # Entity: Orin ‚îÇ ‚îî‚îÄ‚îÄ prompts/ # Prompt templates for
entities ‚îú‚îÄ‚îÄ config/ # Schemas, ethics, and model configs ‚îÇ ‚îú‚îÄ‚îÄ CONFIG.md #
Config documentation ‚îÇ ‚îú‚îÄ‚îÄ ethics/ # Ethical guidelines (e.g.,
LawsOfRobotics.json) ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ LawsOfRobotics.json ‚îÇ ‚îú‚îÄ‚îÄ models/ # Model
configuration files ‚îÇ ‚îî‚îÄ‚îÄ schemas/ # Data schemas for validation ‚îú‚îÄ‚îÄ data/ #
Vector store registry, ingested data ‚îÇ ‚îú‚îÄ‚îÄ vector-stores-registry.json ‚îÇ ‚îî‚îÄ‚îÄ
schemas/ # Data schemas (if present) ‚îú‚îÄ‚îÄ datasets/ # Source datasets for
ingestion/embedding ‚îú‚îÄ‚îÄ docs/ # System, migration, and vector search docs ‚îÇ ‚îú‚îÄ‚îÄ
CONTRIBUTING.md # Contribution guidelines ‚îÇ ‚îú‚îÄ‚îÄ DETAILED.md # This file
(detailed docs) ‚îÇ ‚îú‚îÄ‚îÄ DEVELOPMENT-PRINCIPLES.md ‚îÇ ‚îú‚îÄ‚îÄ naming-conventions.md ‚îÇ
‚îú‚îÄ‚îÄ migration/ # Shell-to-Rust migration plans ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ RECOMMENDED-STRUCTURE.md
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ DIRECTORY-REORGANIZATION.md ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ IMPLEMENTATION-PLAN.md ‚îÇ ‚îî‚îÄ‚îÄ
vector-search/ # Vector search and embedding docs ‚îÇ ‚îú‚îÄ‚îÄ
character-based-chunking.md ‚îÇ ‚îú‚îÄ‚îÄ ollama-embedding-limits.md ‚îÇ ‚îî‚îÄ‚îÄ
jsonl-ingestion.md ‚îú‚îÄ‚îÄ infrastructure/ # Cloud and deployment infrastructure
docs ‚îÇ ‚îú‚îÄ‚îÄ aws-stack.md ‚îÇ ‚îú‚îÄ‚îÄ cost-monitoring.md ‚îÇ ‚îú‚îÄ‚îÄ deployment-guide.md ‚îÇ ‚îî‚îÄ‚îÄ
pinecone-schemas.md ‚îú‚îÄ‚îÄ integration-guides/ # Integration docs for external
APIs/services ‚îÇ ‚îú‚îÄ‚îÄ agentic-orchestration.md ‚îÇ ‚îú‚îÄ‚îÄ
amazon-voice-interoperability.md ‚îÇ ‚îú‚îÄ‚îÄ anthropic.md ‚îÇ ‚îú‚îÄ‚îÄ aws.md ‚îÇ ‚îú‚îÄ‚îÄ
bedrock.md ‚îÇ ‚îú‚îÄ‚îÄ cohere.md ‚îÇ ‚îú‚îÄ‚îÄ google.md ‚îÇ ‚îú‚îÄ‚îÄ griptape.md ‚îÇ ‚îú‚îÄ‚îÄ haystack.md ‚îÇ
‚îú‚îÄ‚îÄ hugging-face.md ‚îÇ ‚îú‚îÄ‚îÄ microsoft.md ‚îÇ ‚îú‚îÄ‚îÄ open-ai.md ‚îÇ ‚îî‚îÄ‚îÄ pinecone.md ‚îú‚îÄ‚îÄ
logs/ # Ingestion and embedding logs ‚îÇ ‚îú‚îÄ‚îÄ embedding*size_test*_.log ‚îÇ ‚îú‚îÄ‚îÄ
ingest*log*_.log ‚îÇ ‚îî‚îÄ‚îÄ embedding_api/ # API-specific logs ‚îú‚îÄ‚îÄ memory-schemas/ #
Schemas for memory and context ‚îÇ ‚îú‚îÄ‚îÄ conversation-metadata.json ‚îÇ ‚îú‚îÄ‚îÄ
emotion-vectors.json ‚îÇ ‚îú‚îÄ‚îÄ entity-context.json ‚îÇ ‚îî‚îÄ‚îÄ narrative-arc.json ‚îú‚îÄ‚îÄ
personality-archetypes/ # Archetype definitions and docs ‚îÇ ‚îú‚îÄ‚îÄ Heralds.json ‚îÇ
‚îú‚îÄ‚îÄ heralds.md ‚îÇ ‚îú‚îÄ‚îÄ mythological/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ celtic/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ norse/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ
human-inspired.md ‚îÇ ‚îî‚îÄ‚îÄ pop-culture/ ‚îÇ ‚îú‚îÄ‚îÄ bojack-horseman/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ Bojack.json
‚îÇ ‚îú‚îÄ‚îÄ literary/ ‚îÇ ‚îî‚îÄ‚îÄ marvel/ ‚îÇ ‚îú‚îÄ‚îÄ MarvelAIs.json ‚îÇ ‚îú‚îÄ‚îÄ
pop-culture-ai-references.md ‚îÇ ‚îî‚îÄ‚îÄ VictorMancha.json ‚îú‚îÄ‚îÄ rust_ingest/ # Rust CLI
tools for ingestion/embedding ‚îÇ ‚îú‚îÄ‚îÄ Cargo.toml ‚îÇ ‚îú‚îÄ‚îÄ Cargo.lock ‚îÇ ‚îú‚îÄ‚îÄ
rustREADME.md ‚îÇ ‚îú‚îÄ‚îÄ src/ ‚îÇ ‚îî‚îÄ‚îÄ target/ ‚îú‚îÄ‚îÄ scripts/ # Shell scripts for
deployment/validation only ‚îÇ ‚îú‚îÄ‚îÄ build_rust_tools.sh ‚îÇ ‚îî‚îÄ‚îÄ validation/ ‚îÇ ‚îú‚îÄ‚îÄ
check-json.sh ‚îÇ ‚îî‚îÄ‚îÄ check-rust.sh ‚îÇ ‚îî‚îÄ‚îÄ deploy/ ‚îÇ ‚îî‚îÄ‚îÄ deploy.sh ‚îú‚îÄ‚îÄ src/ # Core
Rust code (all app logic) ‚îÇ ‚îú‚îÄ‚îÄ ingest/ # Ingestion pipeline logic ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ
marvelai_ingest.rs # Domain-specific ingest wrapper ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ingest.rs # Core
ingest logic ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ chunking_utils.rs # Character-based chunking ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ
embedding.rs # Embedding API integration ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ... ‚îÇ ‚îú‚îÄ‚îÄ utils/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ
json_tools/ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ format_json.rs ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ validate_json_schema.rs ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ
... ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ... ‚îÇ ‚îî‚îÄ‚îÄ target/ # Rust build output (release/debug) ‚îú‚îÄ‚îÄ target/ #
Rust build output (workspace root) ‚îú‚îÄ‚îÄ tests/ # Test fixtures and test code ‚îÇ
‚îú‚îÄ‚îÄ fixtures/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ FIXTURES.md ‚îÇ ‚îú‚îÄ‚îÄ ingest_tests.rs # Ingestion/embedding
tests ‚îÇ ‚îú‚îÄ‚îÄ utils_tests.rs # Utility function tests ‚îÇ ‚îî‚îÄ‚îÄ ... ‚îú‚îÄ‚îÄ workflows/ #
CI/CD and automation configs ‚îÇ ‚îú‚îÄ‚îÄ rust.yml # Rust build/test workflow ‚îÇ ‚îú‚îÄ‚îÄ
lint.yml # Linting/formatting workflow ‚îÇ ‚îî‚îÄ‚îÄ ... ‚îú‚îÄ‚îÄ README.md # Project
overview, build, and dev standards ‚îî‚îÄ‚îÄ Cargo.toml # Rust workspace config (root)
